<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Clock + Pomodoro</title>
    <style>
        :root {
            --bg: #ffffff;
            --fg: #0a0a0a;
            --muted: #6b7280;
            --card: #f5f5f5;
            --accent: #0ea5e9;
            --radius: 18px;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0b0b0b;
                --fg: #f5f5f5;
                --muted: #9ca3af;
                --card: #161616;
                --accent: #38bdf8;
            }
        }

        * {
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
            margin: 0;
            background: var(--bg);
            color: var(--fg);
            font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
        }

        .wrap {
            min-height: 100%;
            display: grid;
            place-items: center;
            padding: 24px;
        }

        .grid {
            width: min(100%, 900px);
            display: grid;
            gap: 18px;
            grid-template-columns: repeat(2, minmax(0, 1fr));
        }

        @media (max-width: 720px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--card);
            border-radius: var(--radius);
            padding: 24px;
            display: grid;
            gap: 16px;
            box-shadow: 0 0 0 1px rgba(0, 0, 0, .04), 0 8px 30px rgba(0, 0, 0, .08);
        }

        .title {
            margin: 0;
            font-size: 14px;
            letter-spacing: .08em;
            text-transform: uppercase;
            color: var(--muted);
        }

        .big {
            font-variant-numeric: tabular-nums;
            line-height: 1;
            text-align: center;
            font-weight: 700;
            font-size: clamp(40px, 10vw, 84px);
            margin: 6px 0 0 0;
        }

        .row {
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        button {
            appearance: none;
            border: none;
            padding: 10px 14px;
            border-radius: 12px;
            background: var(--fg);
            color: var(--bg);
            cursor: pointer;
            font-weight: 600;
            transition: transform .03s ease, opacity .2s ease;
        }

        button.secondary {
            background: transparent;
            color: var(--fg);
            outline: 1px solid rgba(125, 125, 125, .35);
        }

        button:active {
            transform: translateY(1px);
        }

        .hint {
            text-align: center;
            font-size: 12px;
            color: var(--muted);
        }

        a {
            color: var(--accent);
            text-decoration: none;
        }

        a:focus,
        button:focus {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
        }
    </style>
</head>

<body>
    <div class="wrap">
        <div class="grid">
            <!-- Current Time -->
            <section class="card" aria-labelledby="clock-title">
                <h2 class="title" id="clock-title">Current Time</h2>
                <div class="big" id="clock">--:--:--</div>
                <div class="hint" id="date"></div>
            </section>

            <!-- Pomodoro -->
            <section class="card" aria-labelledby="pomo-title">
                <h2 class="title" id="pomo-title">Pomodoro 25:00</h2>
                <div class="big" id="pomo">25:00</div>
                <div class="row">
                    <button id="toggle">Start</button>
                    <button class="secondary" id="reset" title="Reset (R)">Reset</button>
                </div>
                <div class="hint">Space = Start/Pause • R = Reset</div>
            </section>
        </div>
    </div>

    <script>
        // ---------- Live Clock ----------
        const clockEl = document.getElementById('clock');
        const dateEl = document.getElementById('date');

        function pad(n) { return String(n).padStart(2, '0'); }

        function updateClock() {
            const now = new Date();
            const h = pad(now.getHours());
            const m = pad(now.getMinutes());
            const s = pad(now.getSeconds());
            clockEl.textContent = `${h}:${m}:${s}`;
            // Friendly date (updates each tick, cheap)
            dateEl.textContent = now.toLocaleDateString(undefined, {
                weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
            });
        }
        // Keep seconds aligned to system clock
        updateClock();
        setInterval(updateClock, 250);

        // ---------- Pomodoro Timer ----------
        const pomoEl = document.getElementById('pomo');
        const toggleBtn = document.getElementById('toggle');
        const resetBtn = document.getElementById('reset');

        const FULL_MS = 25 * 60 * 1000; // 25 minutes
        let remaining = FULL_MS;
        let running = false;
        let rafId = null;
        let last = 0;

        function fmt(ms) {
            ms = Math.max(0, ms | 0);
            const totalSec = Math.floor(ms / 1000);
            const mm = pad(Math.floor(totalSec / 60));
            const ss = pad(totalSec % 60);
            return `${mm}:${ss}`;
        }

        function render() {
            pomoEl.textContent = fmt(remaining);
            document.title = `${fmt(remaining)} • Pomodoro`;
        }

        function tick(ts) {
            if (!running) return;
            if (!last) last = ts;
            const delta = ts - last;
            last = ts;
            remaining -= delta;
            if (remaining <= 0) {
                remaining = 0;
                running = false;
                last = 0;
                notifyDone();
            }
            render();
            if (running) rafId = requestAnimationFrame(tick);
        }

        function start() {
            if (running) return;
            running = true;
            last = 0;
            toggleBtn.textContent = 'Pause';
            rafId = requestAnimationFrame(tick);
        }

        function pause() {
            running = false;
            last = 0;
            toggleBtn.textContent = 'Start';
            if (rafId) cancelAnimationFrame(rafId);
        }

        function reset() {
            pause();
            remaining = FULL_MS;
            render();
        }

        function notifyDone() {
            // Vibrate if available
            if (navigator.vibrate) {
                navigator.vibrate([200, 120, 200]);
            }
            // Quick beep using Web Audio API
            try {
                const ctx = new (window.AudioContext || window.webkitAudioContext)();
                const o = ctx.createOscillator();
                const g = ctx.createGain();
                o.type = 'sine';
                o.frequency.setValueAtTime(880, ctx.currentTime);
                g.gain.setValueAtTime(0.001, ctx.currentTime);
                g.gain.exponentialRampToValueAtTime(0.2, ctx.currentTime + 0.02);
                g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.6);
                o.connect(g).connect(ctx.destination);
                o.start();
                o.stop(ctx.currentTime + 0.65);
            } catch (e) { }
            // Visual flash in the tab title
            let flashes = 0;
            const iv = setInterval(() => {
                document.title = (flashes % 2 === 0) ? '✓ Break time!' : fmt(0) + ' • Pomodoro';
                if (++flashes > 6) clearInterval(iv);
            }, 400);
            toggleBtn.textContent = 'Start';
        }

        // Wire up controls
        toggleBtn.addEventListener('click', () => running ? pause() : start());
        resetBtn.addEventListener('click', reset);
        window.addEventListener('keydown', (e) => {
            if (e.code === 'Space') { e.preventDefault(); running ? pause() : start(); }
            if (e.key.toLowerCase() === 'r') { e.preventDefault(); reset(); }
        });

        // Initial paint
        render();
    </script>
</body>

</html>